# Сценарий для текстовой ролевой игры на Хэллоуин (Расширенная версия)
# Название: Проклятие «Шепчущей Тыквы»
# resource1: Здоровье
# resource2: Рассудок
scenarios:

  # --- НАЧАЛО ИГРЫ ---
  - id: 1
    description: "Холодная ночь на Самайн. Проливной дождь заставил тебя искать убежище в таверне «Шепчущая Тыква». Внутри тепло, пахнет элем, но в зале пусто. За стойкой нервный трактирщик, в углу — мрачный бард. Что будешь делать?"
    actions:
      - label: "Поговорить с трактирщиком"
        resultText: "Ты подходишь к стойке. Трактирщик, протирая кружку, с тревогой смотрит на лестницу, ведущую наверх."
        nextScenarioId: 2
      - label: "Осмотреться в общем зале"
        resultText: "Твой взгляд скользит по залу. В дальнем углу замечаешь странное холодное пятно, от которого веет могильным холодом."
        nextScenarioId: 3
      - label: "Осмотреть пустые столы"
        resultText: "Ты решаешь осмотреть столы, прежде чем с кем-то говорить."
        nextScenarioId: 4
      - label: "Немедленно снять комнату и уйти спать"
        resultText: "Решив не испытывать судьбу, ты берешь ключ и запираешься в комнате. Ночь кажется бесконечной... Ты слышишь шаги за дверью, но игнорируешь их."
        nextScenarioId: 100

  # --- РАЗГОВОР С ТРАКТИрЩИКОМ ---
  - id: 2
    description: "'Добрый вечер, путник', — бормочет трактирщик. — 'Только одна просьба: не ходи наверх. Каждую ночь на Самайн там появляется Тыквенный Призрак... Говорят, ищет свою потерянную любовь'."
    actions:
      - label: "Призрак? Я разберусь с ним. За плату."
        resultText: "Глаза трактирщика загораются надеждой. 'Правда? Если избавишь нас от этого проклятия, я заплачу тебе золотом!'"
        nextScenarioId: 5
      - label: "Интересная сказка. Расскажи подробнее."
        resultText: "Трактирщик вздыхает. 'Это не сказка. Все началось много лет назад с девушкой по имени Элара...' Он советует поговорить с бардом."
        resource2change: "positive" # Увеличение Рассудка (знание)
        nextScenarioId: 3
      - label: "Что насчет предыдущих... гостей?"
        resultText: "Трактирщик мрачнеет. 'Был один... авантюрист, вроде тебя. Он пошел наверх и не вернулся...'"
        nextScenarioId: 7
      - label: "Пожалуй, я останусь внизу."
        resultText: "Ты решаешь не лезть на рожон и остаешься в общем зале."
        nextScenarioId: 10

  # --- ИССЛЕДОВАНИЕ ЗАЛА ---
  - id: 3
    description: "Ты стоишь посреди общего зала. Бард в углу тихо поет грустную мелодию, а из холодного пятна тянет потусторонним морозом. За окном бушует ливень."
    actions:
      - label: "Поговорить с бардом"
        resultText: "Ты подсаживаешься к барду. 'Эта песня о леди Эларе', — говорит он. — 'Она умерла в этой таверне, ожидая своего возлюбленного'."
        nextScenarioId: 6
      - label: "Исследовать холодное пятно"
        resultText: "Когда ты подходишь, воздух становится ледяным. В ушах раздается шепот: '...он так и не вернулся...'. От этого шепота твой Рассудок трещит по швам."
        resource2change: "negative" # Уменьшение Рассудка
        nextScenarioId: 3
      - label: "Посмотреть в окно"
        resultText: "Ты подходишь к залитому дождем окну. Сквозь потоки воды ты видишь ЕЕ. Фигуру в сером плаще, держащую на палке лошадиный череп с пустыми глазницами. Мари Луид. Она стоит под дождем и смотрит... прямо на тебя."
        nextScenarioId: 18
      - label: "Вернуться к трактирщику"
        resultText: "Ты снова подходишь к стойке."
        nextScenarioId: 2
      - label: "Осмотреть пустые столы"
        resultText: "Ты решаешь осмотреть столы."
        nextScenarioId: 4

  # --- ПУСТЫЕ СТОЛЫ ---
  - id: 4
    description: "Ты подходишь к столам в темном углу. На одном из них ты замечаешь следы борьбы, перевернутую кружку и... странный, обугленный символ, выжженный на дереве."
    actions:
      - label: "Изучить символ"
        resultText: "Символ незнаком, но от него веет злом. Кажется, это что-то связанное с призывом или удержанием. Ваш Рассудок колеблется."
        resource2change: "negative"
        nextScenarioId: 3
      - label: "Посмотреть под столом"
        resultText: "Ты наклоняешься и находишь под столом брошенный кем-то маленький кожаный мешочек. Внутри — крупная соль. Полезная вещь против духов."
        givesItem: "Мешочек с солью"
        nextScenarioId: 3

  # --- ПРИНЯТИЕ ЗАДАНИЯ ---
  - id: 5
    description: "Трактирщик протягивает тебе старый серебряный ключ. 'Это от главной спальни наверху (слева). Удачи тебе, смельчак'."
    actions:
      - label: "Немедленно подняться наверх"
        resultText: "Сжимая ключ в руке, ты направляешься к скрипучей лестнице."
        givesItem: "Серебряный ключ"
        nextScenarioId: 11
      - label: "Сначала соберу больше информации"
        resultText: "Ты решаешь сначала разузнать побольше и возвращаешься в общий зал."
        givesItem: "Серебряный ключ"
        nextScenarioId: 3
      - label: "Спросить о предыдущем смельчаке"
        resultText: "Ты решаешь уточнить, что случилось с тем авантюристом."
        nextScenarioId: 7

  # --- ИСТОРИЯ БАРДА ---
  - id: 6
    description: "Бард рассказывает, что Элара была заперта в своей комнате семьей рыцаря, которого она любила. Они были против их союза. Она умерла от тоски, так и не дождавшись его возвращения с войны. Ее дух до сихр ждет."
    actions:
      - label: "Спросить, где ее заперли"
        resultText: "Бард кивает на лестницу. 'В главной спальне. Говорят, ее ярость породила Тыквенного Призрака, ведь она каждый год вырезала для него фонарь'."
        resource2change: "positive"
        nextScenarioId: 3
      - label: "Спросить барда, не знает ли он слабость духа"
        resultText: "Бард понижает голос, оглядываясь."
        nextScenarioId: 8
      - label: "Поблагодарить и отойти"
        resultText: "Ты благодаришь барда за историю и возвращаешься в центр зала."
        nextScenarioId: 3

  # --- ПРЕДЫДУЩИЕ СМЕЛЬЧАКИ ---
  - id: 7
    description: "Трактирщик мрачнеет. 'Да, был один... авантюрист. Он снял комнату в конце коридора направо. Пошел в главную спальню и не вернулся. Можешь осмотреть его комнату, если хочешь. Вот ключ. Может, найдешь что-то полезное'."
    actions:
      - label: "Взять ключ от комнаты авантюриста"
        resultText: "Ты берешь потертый железный ключ."
        givesItem: "Ключ авантюриста"
        nextScenarioId: 2
      - label: "Нет, я разберусь сам"
        resultText: "Ты решаешь не копаться в чужих вещах."
        nextScenarioId: 2

  # --- СЛАБОСТЬ ДУХА ---
  - id: 8
    description: "Бард понижает голос. 'Говорят, она боится... серебра. Не оружия, а чистого серебра. А еще, как и все духи, соли. Но главная ее слабость — это ее тоска. Напомни ей о рыцаре, но будь осторожен — это может ее как успокоить, так и окончательно свести с ума'."
    actions:
      - label: "Поблагодарить за ценный совет"
        resultText: "Ты киваешь барду. Теперь у тебя есть план."
        resource2change: "positive"
        nextScenarioId: 3

  # --- ПАССИВНЫЙ ПУТЬ ---
  - id: 10
    description: "Ты сидишь за столиком в углу. Время от времени сверху доносятся странные звуки: то ли скрип, то ли тихий плач."
    actions:
      - label: "Все-таки подняться наверх"
        resultText: "Любопытство (или жажда наживы) берет верх."
        nextScenarioId: 11
      - label: "Прислушаться к звукам"
        resultText: "Ты напрягаешь слух, пытаясь разобрать что-то сквозь вой ветра."
        nextScenarioId: 9
      - label: "Ждать до утра"
        resultText: "Ты решаешь не рисковать. Ночь тянется медленно, и ты засыпаешь прямо за столом."
        nextScenarioId: 100

  # --- ПРИСЛУШАТЬСЯ ---
  - id: 9
    description: "Ты напрягаешь слух. Сквозь вой ветра слышится не только плач, но и злобный, скрежещущий шепот на неизвестном языке. Он проникает прямо в твой разум, вызывая пульсирующую боль в висках."
    actions:
      - label: "Продолжать слушать (Риск для Рассудка)"
        resultText: "Шепот становится громче, он говорит о тьме, о голоде... Ты с трудом заставляешь себя перестать слушать. Твой Рассудок серьезно пострадал."
        resource2change: "negative" # Двойной урон убран
        nextScenarioId: 10
      - label: "Хватит. Подняться наверх"
        resultText: "Тебе не нравится этот шепот. Пора действовать."
        nextScenarioId: 11

  # --- ВЕРХНИЙ ЭТАЖ ---
  - id: 11
    description: "Наверху царит мрак и холод. В тусклом свете луны ты видишь коридор. Слева — богато украшенная дверь (главная спальня). Прямо — простая дверь (прислуга). Справа — обшарпанная дверь (комната авантюриста)."
    actions:
      - label: "Открыть главную спальню (Серебряный ключ)"
        requiredItem: "Серебряный ключ"
        resultText: "Серебряный ключ с щелчком поворачивается. Дверь со скрипом открывается, впуская тебя в просторную, покрытую пылью спальню."
        nextScenarioId: 12
      - label: "Открыть комнату авантюриста (Ключ авантюриста)"
        requiredItem: "Ключ авантюриста"
        resultText: "Железный ключ открывает замок. Ты входишь в комнату, где останавливался твой предшественник."
        nextScenarioId: 16
      - label: "Попробовать дверь для прислуги"
        resultText: "Эта дверь не заперта. За ней оказывается маленькая каморка, где ты видишь старый стол, а на нем — небольшой дневник."
        nextScenarioId: 13
      - label: "Сбежать вниз от страха"
        resultText: "Атмосфера наверху слишком гнетущая. Ты в панике сбегаешь вниз. Твой Рассудок страдает от твоей трусости."
        resource2change: "negative"
        nextScenarioId: 10

  # --- КОМНАТА ПРИСЛУГИ ---
  - id: 13
    description: "Ты стоишь в маленькой каморке прислуги. Перед тобой на столе лежит старый дневник в кожаном переплете. В углу валяется какой-то хлам."
    actions:
      - label: "Подобрать и прочитать дневник"
        resultText: "Это записи Элары. Она пишет о любви, и о том, что семья рыцаря заключила сделку с 'тенью'. Эта тень теперь питается ее горем, искажая ее дух. Элара спрятала в своей комнате оберег, который ей подарил рыцарь."
        givesItem: "Старый дневник"
        resource2change: "positive"
        nextScenarioId: 14
      - label: "Обыскать хлам в углу"
        resultText: "Ты роешься в старых вещах. Под грудой ветоши ты находишь маленький, но очень острый серебряный кинжал. Похоже, кто-то из прислуги припрятал."
        givesItem: "Серебряный кинжал"
        nextScenarioId: 13
      - label: "Выйти из комнаты"
        resultText: "Ты выходишь обратно в холодный коридор."
        nextScenarioId: 11

  # --- КОМНАТА АВАНТЮРИСТА ---
  - id: 16
    description: "Ты в комнате авантюриста. Внутри беспорядок, следы борьбы. На столе лежит его дневник, раскрытый на последней записи. В сундуке у кровати что-то есть."
    actions:
      - label: "Прочитать дневник авантюриста"
        resultText: "'...Это не просто призрак. Здесь что-то еще. Тень, что питается ее горем. Яд. Я нашел упоминание, что тень можно ранить чистым железом или серебром, а духа успокоить... но он не успел дописать. Чтение этого сводит с ума."
        givesItem: "Записи авантюриста"
        resource2change: "negative" # Знание, но опасное
        nextScenarioId: 17
      - label: "Обыскать сундук"
        resultText: "Ты открываешь сундук. Внутри, среди пожитков, лежит пустая фляга... но в углу затесалась еще одна, полная. 'Зелье лечения'. Оно восстанавливает Здоровье."
        givesItem: "Зелье лечения" # Заменил Ласточку на более ДнД-шное
        nextScenarioId: 17
      - label: "Выйти в коридор"
        resultText: "Ты выходишь обратно в холодный коридор."
        nextScenarioId: 11

  - id: 17
    description: "Ты в комнате авантюриста. Ты осмотрел все, что мог."
    actions:
      - label: "Выйти в коридор"
        resultText: "Ты выходишь обратно в холодный коридор."
        nextScenarioId: 11

  # --- ПОСЛЕ ПРОЧТЕНИЯ ДНЕВНИКА ЭЛАРЫ ---
  - id: 14
    description: "Теперь ты знаешь правду: дух Элары — жертва. В дневнике сказано, что оберег спрятан под расшатанной половицей у кровати в ее спальне. Он может помочь."
    actions:
      - label: "Идти в главную спальню"
        resultText: "Вооружившись новыми знаниями, ты направляешься к главной спальне."
        nextScenarioId: 11
      - label: "Выйти в коридор"
        resultText: "Ты выходишь обратно в холодный коридор."
        nextScenarioId: 11

  # --- НОВЫЙ СЦЕНАРИЙ: МАРИ ЛУИД ---
  - id: 18
    description: "Фигура с лошадиным черепом стоит неподвижно, словно ожидая приглашения. Ее вид пробирает до костей. Внезапно она открывает челюсть в безмолвном крике, и ты в ужасе отшатываешься от окна."
    resource2change: "negative"
    actions:
      - label: "Что это было?! Спросить трактирщика"
        resultText: "Ты подбегаешь к трактирщику, он бледнеет. 'Серая Кобыла... Она приходит в ночь Самайна. Говорят, она предвестник смерти... Не смотри на нее!'"
        nextScenarioId: 3
      - label: "Спросить барда об этом"
        resultText: "Ты быстро подходишь к барду. 'Мари Луид... Древний дух. Она — страж порога. Раз она здесь, значит, этой ночью кто-то должен уйти... или прийти. Она чувствует тех, кто связан с духами'."
        resource2change: "positive" # Бард дает знание
        nextScenarioId: 3
      - label: "Попытаться игнорировать увиденное"
        resultText: "Ты отходишь от окна, пытаясь выкинуть жуткий образ из головы. Но он уже засел там."
        nextScenarioId: 3

  # --- ГЛАВНАЯ СПАЛЬНЯ И КОНФРОНТАЦИЯ ---
  - id: 12
    description: "В центре комнаты стоит стол, а на нем — большой, зловеще ухмыляющийся фонарь из тыквы. Дверь захлопывается! Воздух леденеет, и перед тобой появляется фигура девушки в слезах. За ее спиной корчится злобная, бесформенная Тень. Это Элара. Что ты будешь делать?"
    actions:
      - label: "Обнажить оружие. 'Исчезни, дух!'"
        resultText: "Призрак издает оглушительный крик! Тень за ее спиной бросается на тебя, нанося удар по твоему Здоровью."
        resource1change: "negative"
        nextScenarioId: 21
      - label: "'Я здесь, чтобы помочь тебе'."
        resultText: "Призрак замирает. 'Помочь?.. Никто не может мне помочь', — шепчет она с тоской. Тень за ее спиной недовольно шипит."
        nextScenarioId: 20
      - label: "Искать оберег (Нужен Рассудок > 30)"
        requiredItem: "Старый дневник"
        requires:
          resource: "resource2"
          greaterThan: 30
        resultText: "Вспомнив запись, ты бросаешься к кровати, игнорируя вопли. Ты находишь половицу и достаешь резной амулет. Он тепло светится."
        givesItem: "Защитный оберег"
        nextScenarioId: 15

  # --- НАХОДКА ОБЕРЕГА ---
  - id: 15
    description: "Ты держишь в руках Защитный оберег. Дух Элары смотрит на него с удивлением, но Тень за ее спиной шипит и готовится к атаке."
    actions:
      - label: "Показать ей оберег"
        resultText: "Когда ты протягиваешь оберег, он вспыхивает светом. Элара отшатывается, но Тень бросается на тебя!"
        nextScenarioId: 30

  # --- ПУТИ РЕШЕНИЯ (ДИАЛОГ) ---
  - id: 20
    description: "Дух Элары слушает тебя, но ее образ нестабилен, и ее искажает темная энергия. 'Слишком поздно', — шепчет она."
    actions:
      - label: "'Я читал твой дневник. Я знаю о Тени!'"
        requiredItem: "Старый дневник"
        resultText: "При упоминании тени призрак кричит, и из нее вырывается темный сгусток энергии! Тень отделяется от нее, готовясь атаковать тебя."
        nextScenarioId: 30
      - label: "'Позволь мне освободить тебя'"
        resultText: "Ты пытаешься успокоить дух, но без знания истинной причины твои слова приносят лишь временное облегчение. Тень снова берет над ней контроль."
        resource2change: "negative"
        nextScenarioId: 101

  # --- ПУТИ РЕШЕНИЯ (БОЙ) ---
  - id: 21
    description: "Ты сражаешься с разъяренным духом, которым управляет Тень. Ее атаки высасывают твое Здоровье и Рассудок."
    actions:
      - label: "Использовать Защитный оберег"
        requiredItem: "Защитный оберег"
        resultText: "Яркий свет ударяет по призраку, и из нее с воплем вырывается Тень. Дух Элары падает на колени, освобожденный."
        nextScenarioId: 30
      - label: "Использовать Серебряный кинжал"
        requiredItem: "Серебряный кинжал"
        resultText: "Ты наносишь удар кинжалом. Он проходит сквозь духа, но ранит Тень! Она воет от боли и отделяется от Элары."
        nextScenarioId: 30
      - label: "Использовать Мешочек с солью"
        requiredItem: "Мешочек с солью"
        resultText: "Ты бросаешь соль, создавая барьер. Это дает тебе передышку, но Тень все еще контролирует духа. Ты теряешь предмет."
        nextScenarioId: 21
      - label: "Выпить 'Зелье лечения'"
        requiredItem: "Зелье лечения"
        resultText: "Ты залпом выпиваешь зелье. Твои раны затягиваются, Здоровье восстанавливается. Ты теряешь предмет."
        resource1change: "positive"
        nextScenarioId: 21
      - label: "Сражаться до конца (Здоровье > 70)"
        requires:
          resource: "resource1"
          greaterThan: 70
        resultText: "Собрав все силы, ты наносишь удар. Фигура призрака мерцает и растворяется. Но Тень смеется и исчезает во тьме. Ты победил, но не выиграл."
        nextScenarioId: 102
      - label: "Потерпеть поражение"
        resultText: "Силы покидают тебя. Последнее, что ты видишь — искаженное гневом лицо призрака. Тьма поглощает тебя."
        nextScenarioId: 999

  # --- ФИНАЛЬНАЯ СХВАТКА С ТЕНЬЮ ---
  - id: 30
    description: "Тень отделена от Элары. Дух девушки рыдает в углу, а темная сущность готовится тебя уничтожить. У тебя есть выбор."
    actions:
      - label: "Изгнать тень Оберегом"
        requiredItem: "Защитный оберег"
        resultText: "Ты направляешь свет оберега на тень. Она визжит и тает. Элара с благодарностью смотрит на тебя и растворяется в свечении. Проклятие снято."
        nextScenarioId: 200
      - label: "Уничтожить тень Кинжалом"
        requiredItem: "Серебряный кинжал"
        resultText: "Серебро впивается в Тень. Она корчится и распадается. Элара, свободная от мучителя, находит покой."
        nextScenarioId: 200
      - label: "Поговорить с Эларой (Дневник Элары)"
        requiredItem: "Старый дневник"
        resultText: "Ты игнорируешь Тень и подходишь к Эларе. 'Он любил тебя'. Ты показываешь ей дневник. Она читает... и находит покой. Тень, лишенная пищи, злобно шипит и растворяется."
        nextScenarioId: 200
      - label: "Подчинить тень (Записи авантюриста, Рассудок > 80)"
        requiredItem: "Записи авантюриста"
        requires:
          resource: "resource2"
          greaterThan: 80
        resultText: "Ты вспоминаешь записи авантюриста о призыве. Используя свой Рассудок как якорь, ты подчиняешь Тень. Она обвивается вокруг твоей руки, став твоим темным союзником."
        nextScenarioId: 201
      - label: "Ничего не делать (или нет предметов)"
        resultText: "Ты медлишь. У тебя нет ни одного способа противостоять Тени. Она набрасывается на тебя, выпивая твое Здоровье и Рассудок. Тьма."
        resource1change: "negative"
        resource2change: "negative"
        nextScenarioId: 999

  # --- КОНЦОВКИ ---
  - id: 100 # Нейтральная концовка
    description: "Ты просыпаешься утром от лучей солнца. В таверне тихо. Ты расплачиваешься с трактирщиком и уходишь, так и не узнав, что произошло этой ночью. (Нейтральная концовка)"

  - id: 101 # Горькая концовка
    description: "Тебе удалось частично успокоить дух Элары, но корень проклятия (Тень) остался. Таверна все еще проклята. Ты уходишь с чувством незавершенного дела. (Плохая концовка)"

  - id: 102 # Концовка наемника
    description: "Ты силой изгнал дух. Трактирщик платит тебе. Но Тень, истинное зло, ушла невредимой и найдет новую жертву. Ты выполнил работу, но не решил проблему. (Нейтральная концовка)"

  - id: 200 # Истинная хорошая концовка
    description: "Ты освободил дух Элары и уничтожил истинное зло. Утром таверна залита солнцем, а трактирщик со слезами на глазах благодарит тебя. Ты уходишь как герой. (Хорошая концовка)"

  - id: 201 # Концовка силы (Темная)
    description: "Ты подчинил себе древнюю тень. Теперь таверна находится под твоей защитой... и властью. Ты уходишь, чувствуя новую, темную силу внутри себя. (Особая концовка)"

  - id: 999 # Смерть
    description: "Твои силы иссякли. Твой дух теперь навеки прикован к этой таверне, став еще одной ее жертвой. Твоя игра окончена. (Очень плохая концовка)"

